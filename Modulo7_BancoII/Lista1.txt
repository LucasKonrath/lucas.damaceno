//EX1

SELECT p.IDPRODUTO, p.NOME FROM PRODUTO p
INNER JOIN PEDIDOITEM ON PEDIDOITEM.IDPRODUTO = p.IDPRODUTO
INNER JOIN PEDIDO ON PEDIDO.IDPEDIDO = PEDIDOITEM.IDPEDIDO
HAVING max(PEDIDO.DATAPEDIDO) <= ADD_MONTHS(TRUNC(SYSDATE), -4)
GROUP BY p.IDPRODUTO, p.NOME

//EX2

UPDATE PRODUTO set situacao='x'
where IDPRODUTO IN(
SELECT p.IDPRODUTO FROM PRODUTO p
INNER JOIN PEDIDOITEM ON PEDIDOITEM.IDPRODUTO = p.IDPRODUTO
INNER JOIN PEDIDO ON PEDIDO.IDPEDIDO = PEDIDOITEM.IDPEDIDO
HAVING max(PEDIDO.DATAPEDIDO) <= ADD_MONTHS(TRUNC(SYSDATE), -4)
GROUP BY p.IDPRODUTO)