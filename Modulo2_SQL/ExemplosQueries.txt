

/* 
1) Criando uma tabela para armazenar um cadastro de nome de países e suas siglas, por exemplo, Brasil e BRA, respectivamente. A coluna IDPais é o identificador de cada registro.
Create table Pais
    ( IDPais   int         not null,
      Nome     varchar(50) not null,
      Sigla    varchar(3),
         constraint PK_Pais primary key (IDPais)
    )

*/
/* INSERE DADOS NA TABELA PAIS
INSERT INTO PAIS(IDpais, Nome, Sigla, DDI)
VALUES (55, 'BRASIL', 'BR',42)	
*/
-- Comando abaixo insere novo campo na tabela PAIS.
-- ALTER TABLE PAIS ADD DDI varchar(5);
-- REMOVE COLUNA DDI DA TABELA PAIS
--ALTER TABLE PAIS DROP COLUMN DDI;


/*	Cria tabela pais com incremento automatico no IDPais. Não permite inicializar campo de ID com valor escolhido.
		Create table Pais
    ( IDPais   int  IDENTITY  not null,
      Nome     varchar(50)    not null,
      Sigla    varchar(3)
    )
*/
-- Adicionar primary key à tabela País.
--alter table pais Add constraint PK_PAIS primary key(IDPais);
-- Adicionar unique key à tabela país.
--Alter table pais add constraint UK_PAIS_Sigla unique(Sigla);
-- Adicionar check à tabela.
--Alter table Pessoa add constraint CC_Pessoa_Situacao check (situacao in('A', 'I', 'C'));
Alter table Pais add Situacao char(1);

Alter table pais add constraint CC_Pais_Situacao check(Situacao in('A', 'C', 'B'));
INSERT INTO PAIS 
VALUES('BOTSUANA', 'BSN','B');
Select * from Pais;


UPDATE EMPREGADO 
SET COMISSAO=0
WHERE COMISSAO IS NULL;
-- Ex 1. Selecionar empregados em ordem de admissão.
select IDEmpregado AS ID, NomeEmpregado as NOME FROM Empregado ORDER BY DataAdmissao ASC;
--Ex.2  Selecionar empregados que não recebem comissão em ordem de admissão.
select * FROM Empregado WHERE Comissao=0  ORDER BY DataAdmissao ASC;
-- Ex. 3 
/*
Cálculo

Faça uma consulta que retorno o nome dos empregados, o salário anual (considere 13 salários), projete também a comissão (considere 12x). As colunas que deverão ser exibidas são:

ID do Empregado
Nome
Salario Anual
Comissão Anual
Renda Anual
*/

SELECT IDEmpregado as ID, NomeEmpregado as Nome, (salario*13) as [Salario Anual],(comissao*12) as [Comissao Anual],(salario*13 + comissao*12) as [Renda Anual]
FROM EMPREGADO 
-- EX 4
/*
Exercício 4

Cálculo e Filtros

Faça uma consulta que liste todos os empregados que tenham o salário anual seja inferior a R$ 18500 ou que tenham o cargo de Atendente. Projetar as seguintes colunas:

ID do Empregado
Nome
Cargo
Salário Mensal
*/
SELECT IDEmpregado as [ID do Empregado],NomeEmpregado as Nome,Cargo,Salario as [Salário Mensal]
FROM EMPREGADO 
WHERE (salario*12) < 18500 OR Cargo='Atendente';

select COUNT(distinct cargo) CargosDistintos,
MIN(Salario) menorSalario,
MAX(Salario) maiorSalario
 from Empregado;

 Select Cargo,Salario,
		Count(1) as TotalEmpregado
from Empregado
group by  Cargo, Salario
having COUNT(1)>1
order by TotalEmpregado asc;

